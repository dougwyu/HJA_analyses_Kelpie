library(raster)
gis <- "J:/UEA/Oregon/gis"
hllshd <- raster(file.path(gis, "r_utm/bE_30m_hlshd.tif"))
be30 <- raster(file.path(gis, "r_utm/bareEarth_m_30m.tif"))
be <- stack(hllshd, be30)
coords <- xyFromCell(be, seq_len(ncell(be)))
be.df <- utils::stack(as.data.frame(getValues(be)))
be.df <- cbind(coords, be.df)
head(be.df)
ggplot(be.df) +
geom_tile(aes(x, y, fill = values)) +
geom_point(aes(X,Y, size = 2), data = xy)+
facet_wrap(~ ind) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
coord_equal()
ggplot(be.df) +
geom_tile(aes(x, y, fill = values)) +
#geom_point(aes(X,Y, size = 2), data = xy)+
facet_wrap(~ ind) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
coord_equal()
unique(be.df$ind)
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")
#geom_point(aes(X,Y, size = 2), data = xy)+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
#geom_point(aes(X,Y, size = 2), data = xy)+
coord_equal()
xy <- data.frame(st_coordinates(resids.sf))
unique(terr.df$ind)[1]
unique(be.df$ind)[1]
xy <- data.frame(resids.sf)
xy$geometry <- NULL
head(xy)
xy <- cbind(st_coordinates(resids.sf), data.frame(resids.sf))
xy$geometry <- NULL
head(xy)
ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, size = 2, col = mean.nsp), data = xy)+
scale_color_viridis_c(option = "A")+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
coord_quickmap()
ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values, alpha = bE_30m_hlshd )) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 1, data = xy)+
scale_color_viridis_c(option = "A")+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values, alpha = bE_30m_hlshd)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 1, data = xy)+
scale_color_viridis_c(option = "A")+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = bE_30m_hlshd)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 1, data = xy)+
scale_color_viridis_c(option = "A")+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values, alpha = bE_30m_hlshd)) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
coord_equal()
head(be.df)
ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 1, data = xy)+
scale_color_viridis_c(option = "A")+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values)) +
scale_fill_gradientn(colours = rev(terrain.colors(225))) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 1, data = xy)+
scale_color_viridis_c(option = "A")+
coord_equal()+
ggtitle("Residuals - non spatial model")
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values)) +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
coord_equal()
tapply(be.df$values, be.df$ind, range)
tapply(be.df$values, be.df$ind, range, na.rm = T)
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values)) +
scale_alpha(range = c(0.25, 0.55), guide = "none")+
coord_equal()
p2 <- ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.sp), size = 2, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - spatial model")
library(cowplot)
p1 <- ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 2, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - non spatial model")
pdf("local/plots/mapped_residuals.pdf", width = 10, height = 5)
getwd()
wd <- here::here()
wd
setwd(file.path(wd, "Hmsc_CD"))
dir()
getwd()
pdf("local/plots/mapped_residuals.pdf", width = 10, height = 5)
plot_grid(p1, p2)
dev.off()
ggplot() +
geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.sp), size = 2, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - spatial model")
ggsave("local/plots/residuals_mapped_nonsp.png", width = 300, height = 300, units = "mm")
p1 <- ggplot() +
#geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values), fill = "grey20") +
#scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 2, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - non spatial model")
p2 <- ggplot() +
#geom_tile(data = subset(be.df, ind = bareEarth_m_30m), aes(x, y, fill = values)) +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, alpha = values), fill = "grey20") +
#scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.sp), size = 2, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - spatial model")
plot_grid(p1, p2)
ggsave("local/plots/residuals_mapped_nonsp.png", width = 300, height = 300, units = "mm")
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill= values)) +
scale_color_grey()+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill= values)) +
scale_fill_grey()+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, col = values)) +
scale_col_grey()+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, col = values)) +
scale_color_grey()+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
scale_fill_gradientn( colours = grey.colors(50, start - 0.3, end = 0.8))
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
scale_fill_gradientn( colours = grey.colors(50, start - 0.3, end = 0.8))+
coord_equal()
ggplot() +
geom_tile(data = subset(be.df, ind = bE_30m_hlshd), aes(x, y, fill = values)) +
scale_fill_gradientn( colours = grey.colors(50, start = 0.3, end = 0.8))+
coord_equal()
tapply(be.df$values, be.df$ind, range, na.rm = T)
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
rm(be)
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
hllshd.df <- utils::stack(as.data.frame(getValues(hllshd)))
hllshd.df <- cbind(coords, hllshd.df)
head(hllshd.df)
range(hllshd.df$values, na.rm=T)
ggplot() +
geom_tile(data = hllshd.df, aes(x, y, fill = values)) +
scale_fill_gradientn( colours = grey.colors(50, start = 0.3, end = 0.8))+
coord_equal()
coords <- xyFromCell(be30, seq_len(ncell(be30)))
be30.df <- utils::stack(as.data.frame(getValues(be30)))
be30.df <- cbind(coords, be30.df)
head(be30.df)
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
hllshd.df <- utils::stack(as.data.frame(hllshd = getValues(hllshd)))
hllshd.df <- cbind(coords, hllshd.df)
head(hllshd.df)
head(getValues(hllshd))
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
hllshd.df <- data.frame(hllshd = getValues(hllshd))
hllshd.df <- cbind(coords, hllshd.df)
head(hllshd.df)
range(hllshd.df$values, na.rm=T)
head(hllshd.df)
hllshd.df <- data.frame(hllshd = getValues(hllshd))
head(hllshd.df)
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
hllshd.df <- data.frame(hllshd = getValues(hllshd))
hllshd.df <- cbind(coords, hllshd.df)
head(hllshd.df)
range(hllshd.df$values, na.rm=T)
coords <- xyFromCell(be30, seq_len(ncell(be30)))
be30.df <- utils::stack(as.data.frame(getValues(be30)))
be30.df <- cbind(coords, be30.df)
head(be30.df)
range(be30.df$values, na.rm=T)
head(getValues(hllshd))
str(getValues(hllshd))
range(str(getValues(hllshd)), na.rm = T)
hllshd <- raster(file.path(gis, "r_utm/bE_30m_hlshd.tif"))
range(str(getValues(hllshd)), na.rm = T)
hllshd <- raster(file.path(gis, "r_utm/bE_30m_hlshd.tif"))
hllshd
str(getValues(hllshd))
range(getValues(hllshd), na.rm = T)
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
hllshd.df <- data.frame(hllshd = getValues(hllshd))
hllshd.df <- cbind(coords, hllshd.df)
head(hllshd.df)
range(hllshd.df$values, na.rm=T)
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
hllshd.df <- data.frame(hllshd = getValues(hllshd))
range(hllshd.df$values, na.rm=T)
head(hllshd.df)
coords <- xyFromCell(hllshd, seq_len(ncell(hllshd)))
hllshd.df <- utils::stack(as.data.frame(getValues(hllshd)))
hllshd.df <- cbind(coords, hllshd.df)
head(hllshd.df)
range(hllshd.df$values, na.rm=T)
ggplot() +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
p1 <- ggplot() +
geom_tile(data = be30.df, aes(x, y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 2, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - non spatial model")
p1
p1 <- ggplot() +
geom_tile(data = be30.df, aes(x, y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.nsp), size = 2, alpha = 0.5, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - non spatial model")
p2 <- ggplot() +
geom_tile(data = be30.df, aes(x, y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_point(aes(X,Y, col = mean.sp), size = 2, alpha = 0.5, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Mean residuals - spatial model")
p3 <- ggplot() +
geom_tile(data = be30.df, aes(x, y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_point(aes(X,Y, col = sd.nsp), size = 2, alpha = 0.5, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Std dev residuals - non spatial model")
p4 <- ggplot() +
geom_tile(data = be30.df, aes(x, y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_fill_gradientn(colours = rev(terrain.colors(225)), name = "Elevation") +
scale_alpha(range = c(0.15, 0.65), guide = "none")+
geom_point(aes(X,Y, col = sd.sp), size = 2, alpha = 0.5, data = xy)+
scale_color_viridis_c(option = "A", name = "Residuals")+
coord_equal()+
ggtitle("Sts dev residuals - spatial model")
plot_grid(p1, p2, p3, p4, ncol = 2)
ggsave("local/plots/mapped_sp_vs_nsp.png", width = 300, height = 300, units = "mm")
be <- stack(hllshd, be30)
be
coords <- xyFromCell(be, seq_len(ncell(be)))
be <- stack(hllshd, be30)
coords <- xyFromCell(be, seq_len(ncell(be)))
be.df <- as.data.frame(values(be))
head(be.df)
be.df <- cbind(coords, be.df)
head(be.df)
by(be.df, range, na.rm = T)
sapply(be.df, range, na.rm = T)
ggplot(be.df) +
geom_tile(aes(x, y, fill = bE_30m_hlshd)) +
scale_fill_gradientn( colours = grey.colors(50, start = 0.3, end = 0.8))+
coord_equal()
ggplot(be.df) +
geom_tile(aes(x, y, alpha = bE_30m_hlshd)) +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile(aes(x, y, fill = bareEarth_m_30m)) +
scale_fill_gradientn( colours = grey.colors(50, start = 0.3, end = 0.8))+
coord_equal()
ggplot(be.df) +
geom_tile(aes(x, y, alpha = bE_30m_hlshd), fill = "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile(aes(x, y, fill = bareEarth_m_30m)) +
scale_fill_gradientn(colours = rev(terrain.colors(255)), name = "Elevation")+
coord_equal()
ggplot(be.df) +
geom_tile(aes(x, y, fill = bareEarth_m_30m)) +
scale_fill_gradientn(colours = rev(terrain.colors(255)), name = "Elevation")+
geom_tile(aes(x, y, alpha = bE_30m_hlshd), fill = "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
std <- brick(file.path(gis, "r_utm/gee/stdDev.tif"))
qnt <- brick(file.path(gis, "r_utm/gee/quantiles.tif"))
cld <- brick(file.path(gis, "r_utm/gee/leastCloud2.tif"))
NAvalue(std) <- -9999
NAvalue(qnt) <- -9999
NAvalue(cld) <- -9999
names(std)
names(qnt)
names(cld)
cellStats(std$ndvi_stdDev, range)
annualStack <- raster::stack(std[[c("ndmi_stdDev")]],
qnt[[c("ndvi_p5", "ndvi_p50", "ndvi_p95",
"ndmi_p5", "ndmi_p50", "ndmi_p95",
"savi_p50")]],
cld[[c("LC08_045029_20180726_B1",
"LC08_045029_20180726_B3","LC08_045029_20180726_B4",
"LC08_045029_20180726_B5",
"LC08_045029_20180726_B7","LC08_045029_20180726_B10")]])
head(hllshd.df)
coords <- xyFromCell(annualStack, seq_len(ncell(annualStack)))
stck.df <- utils::stack(as.data.frame(getValues(annualStack)))
stck.df <- cbind(coords, stck.df)
head(stck.df)
tapply(stck.df$values, stck.df$ind, range, na.rm=T)
unique(stck.df$ind)
stck.sub <- annualStack[[c("ndmi_stdDev", "ndvi_p5", "ndvi_p50", "ndvi_p95")]]
stck.sub
coords <- xyFromCell(stck.sub, seq_len(ncell(annualStack)))
coords <- xyFromCell(stck.sub, seq_len(ncell(stck.sub)))
stck.df <- utils::stack(as.data.frame(getValues(stck.sub)))
stck.df <- cbind(coords, stck.df)
head(stck.df)
tapply(stck.df$values, stck.df$ind, range, na.rm=T)
unique(stck.df$ind)
ggplot(data = stck.df, aes(x = x, y = y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile()+
scale_fill_viridis_c(options = "A", name = "Predictor values") +
coord_equal()+
facet_wrap(~fill, scales = "free")
ggtitle("Predicor - annual series")
ggplot(data = stck.df, aes(x = x, y = y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile()+
scale_fill_viridis_c(options = "A", name = "Predictor values") +
coord_equal()+
facet_wrap(~fill, scales = "free")+
ggtitle("Predicor - annual series")
ggplot(data = stck.df, aes(x = x, y = y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill = "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile()+
scale_fill_viridis_c(option = "A", name = "Predictor values") +
coord_equal()+
facet_wrap(~fill, scales = "free")+
ggtitle("Predicor - annual series")
head(hllshd.df)
ggplot(data = stck.df, aes(x = x, y = y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values)) +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile()+
scale_fill_viridis_c(option = "A", name = "Predictor values") +
coord_equal()+
facet_wrap(~fill, scales = "free")+
ggtitle("Predicor - annual series")
ggplot(data = stck.df, aes(x = x, y = y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile()+
scale_fill_viridis_c(option = "A", name = "Predictor values") +
coord_equal()+
facet_wrap(~ ind, scales = "free")+
ggtitle("Predicor - annual series")
ggplot(data = stck.df, aes(x = x, y = y, fill = values)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile()+
scale_fill_viridis_c(option = "A", name = "Predictor values") +
coord_equal()+
facet_wrap(~ ind)+
ggtitle("Predicor - annual series")
coords <- xyFromCell(stck.sub, seq_len(ncell(stck.sub)))
stck.df <- data.frame(values(stck.sub))
head(stck.df)
stck.df <- cbind(coords, stck.df)
head(stck.df)
sapply(stck.df, range, na.rm=T)
p1 <- ggplot(data = stck.df, aes(x = x, y = y)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile(aes(fill = ndmi_stdDev))+
scale_fill_viridis_c(option = "B", name = "NDMI annual std dev") +
coord_equal()+
p1
ggplot(data = stck.df, aes(x = x, y = y)) +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
geom_tile(aes(fill = ndmi_stdDev))+
scale_fill_viridis_c(option = "B", name = "NDMI annual std dev") +
coord_equal()
p1 <- ggplot(data = stck.df, aes(x = x, y = y)) +
geom_tile(aes(fill = ndmi_stdDev))+
scale_fill_viridis_c(option = "A", name = "NDMI annual std dev") +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
p2 <- ggplot(data = stck.df, aes(x = x, y = y)) +
geom_tile(aes(fill = ndvi_p5))+
scale_fill_viridis_c(option = "B", name = "5 percentile NDVI") +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
p3 <- ggplot(data = stck.df, aes(x = x, y = y)) +
geom_tile(aes(fill = ndvi_p50))+
scale_fill_viridis_c(option = "C", name = "Median NDVI") +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
p4 <- ggplot(data = stck.df, aes(x = x, y = y)) +
geom_tile(aes(fill = ndvi_p95))+
scale_fill_viridis_c(option = "C", name = "95 percentile NDVI") +
geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
plot_grid(p1, p2, p3, p4, ncol = 2)
ggsave("local/plots/predictors_annual.png", width = 300, height = 300, units = "mm")
p1 <- ggplot(data = stck.df, aes(x = x, y = y, fill = ndmi_stdDev)) +
geom_tile()+
scale_fill_viridis_c(option = "B", name = "NDMI annual std dev") +
#geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
#scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
p2 <- ggplot(data = stck.df, aes(x = x, y = y, fill = ndvi_p5)) +
geom_tile()+
scale_fill_viridis_c(option = "C", name = "5 percentile NDVI") +
#geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
#scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
p3 <- ggplot(data = stck.df, aes(x = x, y = y, fill = ndvi_p50)) +
geom_tile()+
scale_fill_viridis_c(option = "B", name = "Median NDVI") +
#geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
#scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
p4 <- ggplot(data = stck.df, aes(x = x, y = y, fill = ndvi_p95)) +
geom_tile()+
scale_fill_viridis_c(option = "C", name = "95 percentile NDVI") +
#geom_tile(data = hllshd.df, aes(x, y, alpha = values), fill= "grey20") +
#scale_alpha(range = c(0.25, 0.65), guide = "none")+
coord_equal()
plot_grid(p1, p2, p3, p4, ncol = 2)
ggsave("local/plots/predictors_annual.png", width = 300, height = 300, units = "mm")
coords <- xyFromCell(stck.sub, seq_len(ncell(stck.sub)))
stck.df <- utils::stack(as.data.frame(getValues(stck.sub)))
stck.df <- cbind(coords, stck.df)
head(stck.df)
ggplot(data = stck.df, aes(x = x, y = y, fill = values)) +
geom_tile()+
scale_fill_viridis_c(option = "B", name = "NDMI annual std dev") +
facet_wrap(~ind)+
coord_equal()
ggsave("local/plots/predictors_annual_facet.png", width = 300, height = 300, units = "mm")
newvars <- c("be10", "tri", "slope", "Nss", "Ess", "ht", "ht.r250", "ht.r500", "ht.r1k", "cov2_4", "cov2_4.r250", "cov2_4.r500", "cov2_4.r1k", "cov4_16", "cov4_16.r250", "cov4_16.r500", "cov4_16.r1k", "be500", "mTopo", "cut.r1k.pt", "insideHJA", "minT_annual", "maxT_annual", "precipitation_mm", "lg_DistStream", "lg_DistRoad", "lg_YrsDisturb", "B1_20180717", "B2_20180717", "B3_20180717", "B4_20180717", "B5_20180717", "B6_20180717", "B7_20180717", "B10_20180717", "B11_20180717", "NDVI_20180717", "EVI_20180717", "B_20180717", "G_20180717", "W_20180717", "l_p25", "l_rumple")
